<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"shoufengsfsf.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="mybatis问题总结作业汇总1、resultType 和 resultMap 的区别?resultType 是&lt;select&gt;标签的一个属性，适合简单对象(POJO、JDK 自带类型: Integer、String、Map 等)，只能自动映射，适合单表简单查询。 123&lt;select id&#x3D;&quot;selectAuthor&quot; parameterType&#x3D;&quot;int&quot; resultTyp">
<meta property="og:type" content="article">
<meta property="og:title" content="mybatis问题总结">
<meta property="og:url" content="https://shoufengsfsf.github.io/2020/06/24/mybatis%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="shoufengsfsf.github.io">
<meta property="og:description" content="mybatis问题总结作业汇总1、resultType 和 resultMap 的区别?resultType 是&lt;select&gt;标签的一个属性，适合简单对象(POJO、JDK 自带类型: Integer、String、Map 等)，只能自动映射，适合单表简单查询。 123&lt;select id&#x3D;&quot;selectAuthor&quot; parameterType&#x3D;&quot;int&quot; resultTyp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gg6x0qv58fj318g0u0k6i.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gg6x44g99kj30wp0u0dmo.jpg">
<meta property="article:published_time" content="2020-06-24T02:45:10.000Z">
<meta property="article:modified_time" content="2020-06-27T08:27:00.877Z">
<meta property="article:author" content="shoufeng">
<meta property="article:tag" content="mybatis应用">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/007S8ZIlly1gg6x0qv58fj318g0u0k6i.jpg">

<link rel="canonical" href="https://shoufengsfsf.github.io/2020/06/24/mybatis%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>mybatis问题总结 | shoufengsfsf.github.io</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">shoufengsfsf.github.io</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://shoufengsfsf.github.io/2020/06/24/mybatis%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="shoufeng">
      <meta itemprop="description" content="工作学习笔记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="shoufengsfsf.github.io">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          mybatis问题总结
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-24 10:45:10" itemprop="dateCreated datePublished" datetime="2020-06-24T10:45:10+08:00">2020-06-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-06-27 16:27:00" itemprop="dateModified" datetime="2020-06-27T16:27:00+08:00">2020-06-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/" itemprop="url" rel="index"><span itemprop="name">mybatis源码解读</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="mybatis问题总结"><a href="#mybatis问题总结" class="headerlink" title="mybatis问题总结"></a>mybatis问题总结</h1><h2 id="作业汇总"><a href="#作业汇总" class="headerlink" title="作业汇总"></a><strong>作业汇总</strong></h2><h3 id="1、resultType-和-resultMap-的区别"><a href="#1、resultType-和-resultMap-的区别" class="headerlink" title="1、resultType 和 resultMap 的区别?"></a>1、resultType 和 resultMap 的区别?</h3><p>resultType 是&lt;select&gt;标签的一个属性，适合简单对象(POJO、JDK 自带类型: Integer、String、Map 等)，只能自动映射，适合单表简单查询。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectAuthor"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"com.gupaoedu.domain.Author"</span>&gt;</span> </span><br><span class="line">  select author_id authorId, author_name authorName from author where author_id = #&#123;authorId&#125; </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>resultMap 是一个可以被引用的标签，适合复杂对象，可指定映射关系，适合关联 复合查询。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BlogWithAuthorResultMap"</span> <span class="attr">type</span>=<span class="string">"com.gupaoedu.domain.associate.BlogAndAuthor"</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"bid"</span> <span class="attr">property</span>=<span class="string">"bid"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span>/&gt;</span> </span><br><span class="line">  <span class="comment">&lt;!-- 联合查询，将 author 的属性映射到 ResultMap --&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"author"</span> <span class="attr">javaType</span>=<span class="string">"com.gupaoedu.domain.Author"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"author_id"</span> <span class="attr">property</span>=<span class="string">"authorId"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"author_name"</span> <span class="attr">property</span>=<span class="string">"authorName"</span>/&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">association</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2、collection-和-association-的区别？"><a href="#2、collection-和-association-的区别？" class="headerlink" title="2、collection 和 association 的区别？"></a><strong>2、collection 和 association 的区别？</strong></h3><p>association：一对一</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 另一种联合查询(一对一)的实现，但是这种方式有“N+1”的问题 --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BlogWithAuthorQueryMap"</span> <span class="attr">type</span>=<span class="string">"com.gupaoedu.domain.associate.BlogAndAuthor"</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"bid"</span> <span class="attr">property</span>=<span class="string">"bid"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span>/&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"author"</span> <span class="attr">javaType</span>=<span class="string">"com.gupaoedu.domain.Author"</span> <span class="attr">column</span>=<span class="string">"author_id"</span> <span class="attr">select</span>=<span class="string">"selectAuthor"</span>/&gt;</span> </span><br><span class="line">  <span class="comment">&lt;!-- selectAuthor 定义在下面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>collection：一对多、多对多 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 查询文章带评论的结果（一对多） --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BlogWithCommentMap"</span> <span class="attr">type</span>=<span class="string">"com.gupaoedu.domain.associate.BlogAndComment"</span> <span class="attr">extends</span>=<span class="string">"BaseResultMap"</span> &gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"comment"</span> <span class="attr">ofType</span>=<span class="string">"com.gupaoedu.domain.Comment"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"comment_id"</span> <span class="attr">property</span>=<span class="string">"commentId"</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"content"</span> <span class="attr">property</span>=<span class="string">"content"</span> /&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 按作者查询文章评论的结果（多对多） --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"AuthorWithBlogMap"</span> <span class="attr">type</span>=<span class="string">"com.gupaoedu.domain.associate.AuthorAndBlog"</span> &gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"author_id"</span> <span class="attr">property</span>=<span class="string">"authorId"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"author_name"</span> <span class="attr">property</span>=<span class="string">"authorName"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span>/&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"blog"</span> <span class="attr">ofType</span>=<span class="string">"com.gupaoedu.domain.associate.BlogAndComment"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"bid"</span> <span class="attr">property</span>=<span class="string">"bid"</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"author_id"</span> <span class="attr">property</span>=<span class="string">"authorId"</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"comment"</span> <span class="attr">ofType</span>=<span class="string">"com.gupaoedu.domain.Comment"</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"comment_id"</span> <span class="attr">property</span>=<span class="string">"commentId"</span> /&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"content"</span> <span class="attr">property</span>=<span class="string">"content"</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3、PrepareStatement-和-Statement-的区别？"><a href="#3、PrepareStatement-和-Statement-的区别？" class="headerlink" title="3、PrepareStatement 和 Statement 的区别？"></a><strong>3、PrepareStatement 和 Statement 的区别？</strong></h3><p>两个都是接口，PrepareStatement 是继承自 Statement 的； </p>
<p>Statement 处理静态 SQL，PreparedStatement 主要用于执行带参数的语句； </p>
<p>PreparedStatement 的 addBatch()方法一次性发送多个查询给数据库； </p>
<p>PS 相似 SQL 只编译一次（对语句进行了缓存，相当于一个函数），减少编译次数；</p>
<p>PS 可以防止 SQL 注入； </p>
<p>MyBatis 默认值：PREPARED </p>
<h3 id="4、跟踪-update-流程，绘制每一步的时序图（4-个）"><a href="#4、跟踪-update-流程，绘制每一步的时序图（4-个）" class="headerlink" title="4、跟踪 update()流程，绘制每一步的时序图（4 个）"></a><strong>4、跟踪 update()流程，绘制每一步的时序图（4 个）</strong></h3><p>自行绘制。 </p>
<h3 id="5、总结：MyBatis-里面用到了哪些设计模式？（已讲解）"><a href="#5、总结：MyBatis-里面用到了哪些设计模式？（已讲解）" class="headerlink" title="5、总结：MyBatis 里面用到了哪些设计模式？（已讲解）"></a><strong>5、总结：MyBatis 里面用到了哪些设计模式？（已讲解）</strong></h3><p>第三次课已讲解，笔记中有。 </p>
<table>
<thead>
<tr>
<th><strong>设计模式</strong></th>
<th><strong>类</strong></th>
</tr>
</thead>
<tbody><tr>
<td>工厂</td>
<td>SqlSessionFactory、ObjectFactory、MapperProxyFactory</td>
</tr>
<tr>
<td>建造者</td>
<td>XMLConfigBuilder、XMLMapperBuilder、XMLStatementBuidler</td>
</tr>
<tr>
<td>单例模式</td>
<td>SqlSessionFactory、Configuration、ErrorContext</td>
</tr>
<tr>
<td>代理模式</td>
<td>绑定：MapperProxy 延迟加载：ProxyFactory（CGLIB、JAVASSIT） 插件：Plugin Spring 集成 MyBaits：SqlSessionTemplate 的内部类 SqlSessionInterceptor MyBatis 自带连接池：PooledDataSource 管理的 PooledConnection 日志打印：ConnectionLogger、StatementLogger</td>
</tr>
<tr>
<td>适配器模式</td>
<td>logging 模块，对于 Log4j、JDK logging 这些没有直接实现 slf4j 接口的日志组件，需要适配器</td>
</tr>
<tr>
<td>模板方法</td>
<td>BaseExecutor 与子类 SimpleExecutor、BatchExecutor、ReuseExecutor</td>
</tr>
<tr>
<td>装饰器模式</td>
<td>LoggingCache、LruCache 等对 PerpectualCache 的装饰 CachingExecutor 对其他 Executor 的装饰</td>
</tr>
<tr>
<td>责任链模式</td>
<td>InterceptorChain</td>
</tr>
</tbody></table>
<h3 id="6、当我们传入-RowBounds-做翻页查询的时候，使用-limit-物理分页，代替原来的逻辑分页"><a href="#6、当我们传入-RowBounds-做翻页查询的时候，使用-limit-物理分页，代替原来的逻辑分页" class="headerlink" title="6、当我们传入 RowBounds 做翻页查询的时候，使用 limit 物理分页，代替原来的逻辑分页"></a><strong>6、当我们传入 RowBounds 做翻页查询的时候，使用 limit 物理分页，代替原来的逻辑分页</strong></h3><p>基于 mybatis-standalone，MyBatisTest.java —— testSelectByRowBounds() &gt;代码在 interceptor 包中 </p>
<h3 id="7、在未启用日志组件的情况下，输出执行的-SQL，并且统计-SQL-的执行时间（先实现查询-的拦截）"><a href="#7、在未启用日志组件的情况下，输出执行的-SQL，并且统计-SQL-的执行时间（先实现查询-的拦截）" class="headerlink" title="7、在未启用日志组件的情况下，输出执行的 SQL，并且统计 SQL 的执行时间（先实现查询 的拦截）"></a><strong>7、在未启用日志组件的情况下，输出执行的 SQL，并且统计 SQL 的执行时间（先实现查询</strong> <strong>的拦截）</strong></h3><p>&gt;代码在 interceptor 包中 </p>
<h2 id="面试题总结"><a href="#面试题总结" class="headerlink" title="面试题总结"></a><strong>面试题总结</strong></h2><h3 id="1、MyBatis-解决了什么问题？"><a href="#1、MyBatis-解决了什么问题？" class="headerlink" title="1、MyBatis 解决了什么问题？"></a><strong>1、MyBatis 解决了什么问题？</strong></h3><p>或：为什么要用 MyBatis？ </p>
<p>或：MyBatis 的核心特性？ </p>
<p>1）资源管理（底层对象封装和支持数据源） </p>
<p>2）结果集自动映射 </p>
<p>3）SQL 与代码分离，集中管理 </p>
<p>4）参数映射和动态 SQL </p>
<p>5）其他：缓存、插件等 </p>
<h3 id="2、MyBatis-编程式开发中的核心对象及其作用？"><a href="#2、MyBatis-编程式开发中的核心对象及其作用？" class="headerlink" title="2、MyBatis 编程式开发中的核心对象及其作用？"></a><strong>2、MyBatis 编程式开发中的核心对象及其作用？</strong></h3><p>SqlSessionFactoryBuilder 创建工厂类 </p>
<p>SqlSessionFactory 创建会话 </p>
<p>SqlSession 提供操作接口 </p>
<p>MapperProxy 代理 Mapper 接口后，用于找到 SQL 执行 </p>
<h3 id="3、Java-类型和数据库类型怎么实现相互映射？"><a href="#3、Java-类型和数据库类型怎么实现相互映射？" class="headerlink" title="3、Java 类型和数据库类型怎么实现相互映射？"></a><strong>3、Java 类型和数据库类型怎么实现相互映射？</strong></h3><p>通过 TypeHandler，例如 Java 类型中的 String 要保存成 varchar，就会自动调用相应的 Handler。如果没有系统自带的 TypeHandler，也可以自定义。</p>
<h3 id="4、SIMPLE-REUSE-BATCH-三种执行器的区别？"><a href="#4、SIMPLE-REUSE-BATCH-三种执行器的区别？" class="headerlink" title="4、SIMPLE/REUSE/BATCH 三种执行器的区别？"></a><strong>4、SIMPLE/REUSE/BATCH 三种执行器的区别？</strong></h3><p>SimpleExecutor 使用后直接关闭 Statement：closeStatement(stmt); </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SimpleExecutor.java </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">doUpdate</span><span class="params">(MappedStatement ms, Object parameter)</span> <span class="keyword">throws</span> SQLException </span>&#123; </span><br><span class="line">  Statement stmt = <span class="keyword">null</span>; </span><br><span class="line">  <span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">//中间省略…… </span></span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  closeStatement(stmt); </span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ReuseExecutor 放在缓存中，可复用：PrepareStatement——getStatement()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ReuseExecutor.Java </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">doUpdate</span><span class="params">(MappedStatement ms, Object parameter)</span> <span class="keyword">throws</span> SQLException </span>&#123; </span><br><span class="line">  <span class="comment">//中间省略…… </span></span><br><span class="line">  Statement stmt = prepareStatement(handler, ms.getStatementLog()); </span><br><span class="line">  <span class="comment">//中间省略…… </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> Statement <span class="title">prepareStatement</span><span class="params">(StatementHandler handler, Log statementLog)</span> <span class="keyword">throws</span> SQLException </span>&#123; </span><br><span class="line">  Statement stmt; </span><br><span class="line">  <span class="comment">//中间省略…… </span></span><br><span class="line">  <span class="keyword">if</span> (hasStatementFor(sql)) &#123; </span><br><span class="line">    stmt = getStatement(sql); </span><br><span class="line">    <span class="comment">//中间省略…… </span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Statement <span class="title">getStatement</span><span class="params">(String s)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> statementMap.get(s); </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BatchExecutor 支持复用且可以批量执行 update()，通过 ps.addBatch()实现handler.batch(stmt); </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BatchExecutor.Java </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">doUpdate</span><span class="params">(MappedStatement ms, Object parameterObject)</span> <span class="keyword">throws</span> SQLException </span>&#123; </span><br><span class="line">  <span class="comment">//中间省略…… </span></span><br><span class="line">  <span class="keyword">final</span> Statement stmt; </span><br><span class="line">  <span class="comment">//中间省略…… </span></span><br><span class="line">  stmt = statementList.get(last); </span><br><span class="line">  <span class="comment">//中间省略…… </span></span><br><span class="line">  statementList.add(stmt); </span><br><span class="line">  batchResultList.add(<span class="keyword">new</span> BatchResult(ms, sql, parameterObject)); </span><br><span class="line">&#125;</span><br><span class="line">handler.batch(stmt); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7、MyBatis-一级缓存与二级缓存的区别？"><a href="#7、MyBatis-一级缓存与二级缓存的区别？" class="headerlink" title="7、MyBatis 一级缓存与二级缓存的区别？"></a><strong>7、MyBatis 一级缓存与二级缓存的区别？</strong></h3><p>一级缓存：在同一个会话（SqlSession）中共享，默认开启，维护在 BaseExecutor中。</p>
<p>二级缓存：在同一个 namespace 共享，需要在 Mapper.xml 中开启，维护在CachingExecutor 中。 </p>
<h3 id="8、MyBaits-支持哪些数据源类型？"><a href="#8、MyBaits-支持哪些数据源类型？" class="headerlink" title="8、MyBaits 支持哪些数据源类型？"></a><strong>8、MyBaits 支持哪些数据源类型？</strong></h3><p>UNPOOLED：不带连接池的数据源。</p>
<p>POOLED ： 带 连 接 池 的 数 据 源 ， 在 PooledDataSource 中 维 护PooledConnection。</p>
<p>PooledDataSource 的 getConnection()方法流程图：</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gg6x0qv58fj318g0u0k6i.jpg" alt="image-20200627161344005"></p>
<p>JNDI：使用容器的数据源，比如 Tomcat 配置了 C3P0。 </p>
<p>自定义数据源：实现 DataSourceFactory 接口，返回一个 DataSource。 </p>
<p>当 MyBatis 集成到 Spring 中的时候，使用 Spring 的数据源。</p>
<h3 id="9、关联查询的延迟加载是怎么实现的？"><a href="#9、关联查询的延迟加载是怎么实现的？" class="headerlink" title="9、关联查询的延迟加载是怎么实现的？"></a><strong>9、关联查询的延迟加载是怎么实现的？</strong></h3><p>动态代理（JAVASSIST、CGLIB），在创建实体类对象时进行代理，在调用代理对象的相关方法时触发二次查询。 </p>
<h3 id="10、MyBatis-翻页的几种方式和区别？"><a href="#10、MyBatis-翻页的几种方式和区别？" class="headerlink" title="10、MyBatis 翻页的几种方式和区别？"></a><strong>10、MyBatis 翻页的几种方式和区别？</strong></h3><p>逻辑翻页：通过 RowBounds 对象。 </p>
<p>物理翻页：通过改写 SQL 语句，可用插件拦截 Executor 实现。 </p>
<h3 id="11、怎么解决表字段变化引起的-MBG-文件变化的问题？"><a href="#11、怎么解决表字段变化引起的-MBG-文件变化的问题？" class="headerlink" title="11、怎么解决表字段变化引起的 MBG 文件变化的问题？"></a><strong>11、怎么解决表字段变化引起的 MBG 文件变化的问题？</strong></h3><p>Mapper 继 承 ： 自 动 生 成 的 部 分 不 变 ， 创 建 接 口 继 承 原 接 口 ， 创 建 </p>
<p>MapperExt.xml。在继承接口和 MapperExt.xml 中修改。 </p>
<p>通用 Mapper：提供支持泛型的通用 Mapper 接口，传入对象类型。</p>
<h3 id="13、解析全局配置文件的时候，做了什么？"><a href="#13、解析全局配置文件的时候，做了什么？" class="headerlink" title="13、解析全局配置文件的时候，做了什么？"></a><strong>13、解析全局配置文件的时候，做了什么？</strong></h3><p>创建 Configuration，设置 Configuration </p>
<p>解析 Mapper.xml，设置 MappedStatement </p>
<h3 id="14、没有实现类，MyBatis-的方法是怎么执行的？"><a href="#14、没有实现类，MyBatis-的方法是怎么执行的？" class="headerlink" title="14、没有实现类，MyBatis 的方法是怎么执行的？"></a><strong>14、没有实现类，MyBatis 的方法是怎么执行的？</strong></h3><p>MapperProxy 代理，代理类的 invoke()方法中调用了 SqlSession.selectOne()</p>
<h3 id="15、接口方法和映射器的-statement-id-是怎么绑定起来的？"><a href="#15、接口方法和映射器的-statement-id-是怎么绑定起来的？" class="headerlink" title="15、接口方法和映射器的 statement id 是怎么绑定起来的？"></a><strong>15、接口方法和映射器的 statement id 是怎么绑定起来的？</strong></h3><p>（怎么根据接口方法拿到 SQL 语句的？） </p>
<p>MappedStatement 对象中存储了 statement 和 SQL 的映射关系 </p>
<h3 id="16、四大对象是什么时候创建的？"><a href="#16、四大对象是什么时候创建的？" class="headerlink" title="16、四大对象是什么时候创建的？"></a><strong>16、四大对象是什么时候创建的？</strong></h3><p>Executor：openSession() </p>
<p>StatementHandler、ResultsetHandler、ParameterHandler： </p>
<p>执行 SQL 时，在 SimpleExecutor 的 doQuery()中创建 </p>
<h3 id="17、ObjectFactory-的-create-方法什么时候被调用？"><a href="#17、ObjectFactory-的-create-方法什么时候被调用？" class="headerlink" title="17、ObjectFactory 的 create()方法什么时候被调用？"></a><strong>17、ObjectFactory 的 create()方法什么时候被调用？</strong></h3><p>第一次被调用，创建 DefaultResultHandler 的时候： DefaultResultSetHandler 类中： handleResultSet new DefaultResultHandler() </p>
<p>第二次被调用，处理结果集的时候： </p>
<p>DefaultResultSetHandler </p>
<p>handleResultSets—— </p>
<p>handleRowValues—— </p>
<p>handleRowValuesForSimpleResultMap—— </p>
<p>getRowValue—— </p>
<p>createResultObject—— </p>
<p>createResultObject——</p>
<h3 id="18、MyBatis-哪些地方用到了代理模式？"><a href="#18、MyBatis-哪些地方用到了代理模式？" class="headerlink" title="18、MyBatis 哪些地方用到了代理模式？"></a><strong>18、MyBatis 哪些地方用到了代理模式？</strong></h3><p>接口查找 SQL：MapperProxy </p>
<p>日志输出：ConnectionLogger、StatementLogger </p>
<p>连接池：PooledDataSource 管理的 PooledConnection </p>
<p>延迟加载：ProxyFactory（JAVASSIST、CGLIB） </p>
<p>插件：Plugin </p>
<p>Spring 集成：SqlSessionTemplate 的内部类 SqlSessionInterceptor </p>
<h3 id="19、MyBatis-主要的执行流程？涉及到哪些对象？"><a href="#19、MyBatis-主要的执行流程？涉及到哪些对象？" class="headerlink" title="19、MyBatis 主要的执行流程？涉及到哪些对象？"></a><strong>19、MyBatis 主要的执行流程？涉及到哪些对象？</strong></h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlly1gg6x44g99kj30wp0u0dmo.jpg" alt="image-20200627161702377"></p>
<h3 id="20、MyBatis-插件怎么编写和使用？原理是什么？（画图）"><a href="#20、MyBatis-插件怎么编写和使用？原理是什么？（画图）" class="headerlink" title="20、MyBatis 插件怎么编写和使用？原理是什么？（画图）"></a><strong>20、MyBatis 插件怎么编写和使用？原理是什么？（画图）</strong></h3><p>使用：继承 Interceptor 接口，加上注解，在 mybatis-config.xml 中配置 </p>
<p>原理：动态代理，责任链模式，使用 Plugin 创建代理对象 </p>
<p>在被拦截对象的方法调用的时候，先走到 Plugin 的 invoke()方法，再走到 Interceptor 实现类的 intercept()方法，最后通过 Invocation.proceed()方法调用被 拦截对象的原方法 </p>
<h3 id="21、JDK-动态代理，代理能不能被代理？"><a href="#21、JDK-动态代理，代理能不能被代理？" class="headerlink" title="21、JDK 动态代理，代理能不能被代理？"></a><strong>21、JDK 动态代理，代理能不能被代理？</strong></h3><p>能</p>
<h3 id="22、MyBatis-集成到-Spring-的原理是什么？"><a href="#22、MyBatis-集成到-Spring-的原理是什么？" class="headerlink" title="22、MyBatis 集成到 Spring 的原理是什么？"></a><strong>22、MyBatis 集成到 Spring 的原理是什么？</strong></h3><p>SqlSessionTemplate 中有内部类SqlSessionInterceptor对DefaultSqlSession 进行代理； </p>
<p>MapperFactoryBean 继 承 了 SqlSessionDaoSupport 获 取 SqlSessionTemplate； </p>
<p>接口注册到 IOC 容器中的 beanClass 是 MapperFactoryBean。 </p>
<h3 id="23、DefaulSqlSession-和-SqlSessionTemplate-的区别是什么？"><a href="#23、DefaulSqlSession-和-SqlSessionTemplate-的区别是什么？" class="headerlink" title="23、DefaulSqlSession 和 SqlSessionTemplate 的区别是什么？"></a><strong>23、DefaulSqlSession 和 SqlSessionTemplate 的区别是什么？</strong></h3><p>1）为什么 SqlSessionTemplate 是线程安全的？</p>
<p>其内部类 SqlSessionInterceptor 的 invoke()方法中的 getSqlSession()方法： </p>
<p>如果当前线程已经有存在的 SqlSession 对象，会在 ThreadLocal 的容器中拿到 SqlSessionHolder，获取 DefaultSqlSession。 </p>
<p>如果没有，则会 new 一个 SqlSession，并且绑定到 SqlSessionHolder，放到 ThreadLocal 中。 </p>
<p>SqlSessionTemplate 中在同一个事务中使用同一个 SqlSession。 </p>
<p>调用 closeSqlSession()关闭会话时，如果存在事务，减少 holder 的引用计数。否 则直接关闭 SqlSession。 </p>
<p>2）在编程式的开发中，有什么方法保证 SqlSession 的线程安全？</p>
<p>SqlSessionManager 同时实现了 SqlSessionFactory、SqlSession 接口，通过ThreadLocal 容器维护 SqlSession。 </p>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a><strong>常见问题</strong></h2><h3 id="用注解还是用-xml-配置？"><a href="#用注解还是用-xml-配置？" class="headerlink" title="用注解还是用 xml 配置？"></a><strong>用注解还是用 xml 配置？</strong></h3><p>常用注解：@Insert、@Select、@Update、@Delete、@Param、@Results、 @Result </p>
<p>在 MyBatis 的工程中，我们有两种配置 SQL 的方式。一种是在 Mapper.xml 中集中管理，一种是在 Mapper 接口上，用注解方式配置 SQL。很多同学在工作中可能两种方式都用过。那到底什么时候用 XML 的方式，什么时候用注解的方式呢？ </p>
<p>注解的缺点是 SQL 无法集中管理，复杂的 SQL 很难配置。所以建议在业务复杂的项目中只使用 XML 配置的形式，业务简单的项目中可以使用注解和 XML 混用的形式。 </p>
<h3 id="Mapper-接口无法注入或-Invalid-bound-statement-not-found"><a href="#Mapper-接口无法注入或-Invalid-bound-statement-not-found" class="headerlink" title="Mapper 接口无法注入或 Invalid bound statement (not found)"></a><strong>Mapper 接口无法注入或 Invalid bound statement (not found)</strong></h3><p>我们在使用 MyBatis 的时候可能会遇到 Mapper 接口无法注入，或者 mapper statement id 跟 Mapper 接口方法无法绑定的情况。基于绑定的要求或者说规范，我们可以从这些地方去检查一下： </p>
<p>1、扫描配置，xml 文件和 Mapper 接口有没有被扫描到 </p>
<p>2、namespace 的值是否和接口全类名一致 </p>
<p>3、检查对应的 sql 语句 ID 是否存在 </p>
<h3 id="怎么获取插入的最新自动生成的-ID"><a href="#怎么获取插入的最新自动生成的-ID" class="headerlink" title="怎么获取插入的最新自动生成的 ID"></a><strong>怎么获取插入的最新自动生成的 ID</strong></h3><p>在 MySQL 的插入数据使用自增 ID 这种场景，有的时候我们需要获得最新的自增 ID， 比如获取最新的用户 ID。常见的做法是执行一次查询，max 或者 order by 倒序获取最大的 ID（低效、存在并发问题）。在 MyBatis 里面还有一种更简单的方式： </p>
<p>insert 成功之后，mybatis 会将插入的值自动绑定到插入的对象的 Id 属性中，我们用 getId 就能取到最新的 ID。 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insert"</span> <span class="attr">parameterType</span>=<span class="string">"com.gupaoedu.domain.Blog"</span>&gt;</span> </span><br><span class="line">  insert into blog (bid, name, author_id) values (#&#123;bid,jdbcType=INTEGER&#125;, #&#123;name,jdbcType=VARCHAR&#125;, #&#123;author,jdbcType=CHAR&#125;) </span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="如何实现模糊查询-LIKE"><a href="#如何实现模糊查询-LIKE" class="headerlink" title="如何实现模糊查询 LIKE"></a><strong>如何实现模糊查询 LIKE</strong></h3><p>1、字符串拼接在 Java 代码中拼接%%（比如 name <em>=</em> <strong>“%”</strong> <em>+</em> name <em>+</em> <strong>“%”</strong>; ），直接 LIKE。因为没 有预编译，存在 SQL 注入的风险，不推荐使用。 </p>
<p>2、CONCAT（推荐）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"empName != null and empName != ''"</span>&gt;</span> </span><br><span class="line">  AND e.emp_name LIKE CONCAT(CONCAT('%', #&#123;emp_name, jdbcType=VARCHAR&#125;),'%') </span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3、bind 标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpList_bind"</span> <span class="attr">resultType</span>=<span class="string">"empResultMap"</span> <span class="attr">parameterType</span>=<span class="string">"Employee"</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">"pattern1"</span> <span class="attr">value</span>=<span class="string">"'%' + empName + '%'"</span> /&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">"pattern2"</span> <span class="attr">value</span>=<span class="string">"'%' + email + '%'"</span> /&gt;</span> </span><br><span class="line">  SELECT * FROM tbl_emp </span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"empId != null"</span>&gt;</span> </span><br><span class="line">      emp_id = #&#123;empId,jdbcType=INTEGER&#125;, </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"empName != null and empName != ''"</span>&gt;</span> </span><br><span class="line">      AND emp_name LIKE #&#123;pattern1&#125; </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email != null and email != ''"</span>&gt;</span> </span><br><span class="line">      AND email LIKE #&#123;pattern2&#125; </span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span> </span><br><span class="line">  ORDER BY emp_id </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="什么时候用-，什么时候用-？"><a href="#什么时候用-，什么时候用-？" class="headerlink" title="什么时候用#{}，什么时候用${}？"></a><strong>什么时候用#{}，什么时候用${}？</strong></h3><p>在 Mapper.xml 里面配置传入参数，有两种写法：#{} 、${}。作为 OGNL 表达式，都可以实现参数的替换。这两种方式的区别在哪里？什么时候应该用哪一种？ </p>
<p>要搞清楚这个问题，我们要先来说一下 PrepareStatement 和 Statement 的区别。 </p>
<p>1、两个都是接口，PrepareStatement 是继承自 Statement 的； </p>
<p>2、Statement 处理静态 SQL，PreparedStatement 主要用于执行带参数的语句； </p>
<p>3、PreparedStatement 的 addBatch()方法一次性发送多个查询给数据库； </p>
<p>4、PS 相似 SQL 只编译一次（对语句进行了缓存，相当于一个函数）,比如语句相 </p>
<p>同参数不同，可以减少编译次数； </p>
<p>5、PS 可以防止 SQL 注入。 </p>
<p>MyBatis 任意语句的默认值：PREPARED </p>
<p>这两个符号的解析方式是不一样的： </p>
<p>#会解析为 Prepared Statement 的参数标记符，参数部分用？代替。传入的参数会经过类型检查和安全检查。 </p>
<p>（mybatis-standalone - MyBatisTest - testSelect()）</p>
<p>$只会做字符串替换，比如参数是咕泡学院，结果如下： </p>
<p>（mybatis-standalone - MyBatisTest - selectBlogByBean ()） </p>
<p>#和$的区别： </p>
<p>1、 是否能防止 SQL 注入：$方式不会对符号转义，不能防止 SQL 注入 </p>
<p>2、 性能：$方式没有预编译，不会缓存 </p>
<p>结论：</p>
<p>1、 能用#的地方都用# </p>
<p>2、 常量的替换，比如排序条件中的字段名称，不用加单引号，可以使用$ </p>
<h3 id="对象属性是基本类型-int-double，数据库返回-null-是报错"><a href="#对象属性是基本类型-int-double，数据库返回-null-是报错" class="headerlink" title="对象属性是基本类型 int double，数据库返回 null 是报错"></a><strong>对象属性是基本类型 int double，数据库返回 null 是报错</strong></h3><p>使用包装类型。如 Integer，不要使用基本类型如 int。 </p>
<h3 id="If-test-null-失效了？"><a href="#If-test-null-失效了？" class="headerlink" title="If test !=null 失效了？"></a><strong>If test !=null 失效了？</strong></h3><p>在实体类中使用包装类型。 </p>
<h3 id="XML-中怎么使用特殊符号，比如小于-amp"><a href="#XML-中怎么使用特殊符号，比如小于-amp" class="headerlink" title="XML 中怎么使用特殊符号，比如小于 &amp;"></a><strong>XML 中怎么使用特殊符号，比如小于 &amp;</strong></h3><p>1、转义&lt; &lt; （大于可以直接写） </p>
<p>2、使用&lt;![CDATA[ ]]&gt;——当 XML 遇到这种格式就会把[]里面的内容原样输出，不 进行解析 </p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/mybatis%E5%BA%94%E7%94%A8/" rel="tag"># mybatis应用</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/06/23/mybatis%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB/" rel="prev" title="mybatis源码解读">
      <i class="fa fa-chevron-left"></i> mybatis源码解读
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#mybatis问题总结"><span class="nav-number">1.</span> <span class="nav-text">mybatis问题总结</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#作业汇总"><span class="nav-number">1.1.</span> <span class="nav-text">作业汇总</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、resultType-和-resultMap-的区别"><span class="nav-number">1.1.1.</span> <span class="nav-text">1、resultType 和 resultMap 的区别?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、collection-和-association-的区别？"><span class="nav-number">1.1.2.</span> <span class="nav-text">2、collection 和 association 的区别？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、PrepareStatement-和-Statement-的区别？"><span class="nav-number">1.1.3.</span> <span class="nav-text">3、PrepareStatement 和 Statement 的区别？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、跟踪-update-流程，绘制每一步的时序图（4-个）"><span class="nav-number">1.1.4.</span> <span class="nav-text">4、跟踪 update()流程，绘制每一步的时序图（4 个）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、总结：MyBatis-里面用到了哪些设计模式？（已讲解）"><span class="nav-number">1.1.5.</span> <span class="nav-text">5、总结：MyBatis 里面用到了哪些设计模式？（已讲解）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、当我们传入-RowBounds-做翻页查询的时候，使用-limit-物理分页，代替原来的逻辑分页"><span class="nav-number">1.1.6.</span> <span class="nav-text">6、当我们传入 RowBounds 做翻页查询的时候，使用 limit 物理分页，代替原来的逻辑分页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、在未启用日志组件的情况下，输出执行的-SQL，并且统计-SQL-的执行时间（先实现查询-的拦截）"><span class="nav-number">1.1.7.</span> <span class="nav-text">7、在未启用日志组件的情况下，输出执行的 SQL，并且统计 SQL 的执行时间（先实现查询 的拦截）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面试题总结"><span class="nav-number">1.2.</span> <span class="nav-text">面试题总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、MyBatis-解决了什么问题？"><span class="nav-number">1.2.1.</span> <span class="nav-text">1、MyBatis 解决了什么问题？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、MyBatis-编程式开发中的核心对象及其作用？"><span class="nav-number">1.2.2.</span> <span class="nav-text">2、MyBatis 编程式开发中的核心对象及其作用？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、Java-类型和数据库类型怎么实现相互映射？"><span class="nav-number">1.2.3.</span> <span class="nav-text">3、Java 类型和数据库类型怎么实现相互映射？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、SIMPLE-REUSE-BATCH-三种执行器的区别？"><span class="nav-number">1.2.4.</span> <span class="nav-text">4、SIMPLE&#x2F;REUSE&#x2F;BATCH 三种执行器的区别？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、MyBatis-一级缓存与二级缓存的区别？"><span class="nav-number">1.2.5.</span> <span class="nav-text">7、MyBatis 一级缓存与二级缓存的区别？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、MyBaits-支持哪些数据源类型？"><span class="nav-number">1.2.6.</span> <span class="nav-text">8、MyBaits 支持哪些数据源类型？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、关联查询的延迟加载是怎么实现的？"><span class="nav-number">1.2.7.</span> <span class="nav-text">9、关联查询的延迟加载是怎么实现的？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、MyBatis-翻页的几种方式和区别？"><span class="nav-number">1.2.8.</span> <span class="nav-text">10、MyBatis 翻页的几种方式和区别？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11、怎么解决表字段变化引起的-MBG-文件变化的问题？"><span class="nav-number">1.2.9.</span> <span class="nav-text">11、怎么解决表字段变化引起的 MBG 文件变化的问题？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13、解析全局配置文件的时候，做了什么？"><span class="nav-number">1.2.10.</span> <span class="nav-text">13、解析全局配置文件的时候，做了什么？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14、没有实现类，MyBatis-的方法是怎么执行的？"><span class="nav-number">1.2.11.</span> <span class="nav-text">14、没有实现类，MyBatis 的方法是怎么执行的？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15、接口方法和映射器的-statement-id-是怎么绑定起来的？"><span class="nav-number">1.2.12.</span> <span class="nav-text">15、接口方法和映射器的 statement id 是怎么绑定起来的？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16、四大对象是什么时候创建的？"><span class="nav-number">1.2.13.</span> <span class="nav-text">16、四大对象是什么时候创建的？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17、ObjectFactory-的-create-方法什么时候被调用？"><span class="nav-number">1.2.14.</span> <span class="nav-text">17、ObjectFactory 的 create()方法什么时候被调用？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18、MyBatis-哪些地方用到了代理模式？"><span class="nav-number">1.2.15.</span> <span class="nav-text">18、MyBatis 哪些地方用到了代理模式？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#19、MyBatis-主要的执行流程？涉及到哪些对象？"><span class="nav-number">1.2.16.</span> <span class="nav-text">19、MyBatis 主要的执行流程？涉及到哪些对象？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#20、MyBatis-插件怎么编写和使用？原理是什么？（画图）"><span class="nav-number">1.2.17.</span> <span class="nav-text">20、MyBatis 插件怎么编写和使用？原理是什么？（画图）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21、JDK-动态代理，代理能不能被代理？"><span class="nav-number">1.2.18.</span> <span class="nav-text">21、JDK 动态代理，代理能不能被代理？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#22、MyBatis-集成到-Spring-的原理是什么？"><span class="nav-number">1.2.19.</span> <span class="nav-text">22、MyBatis 集成到 Spring 的原理是什么？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#23、DefaulSqlSession-和-SqlSessionTemplate-的区别是什么？"><span class="nav-number">1.2.20.</span> <span class="nav-text">23、DefaulSqlSession 和 SqlSessionTemplate 的区别是什么？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常见问题"><span class="nav-number">1.3.</span> <span class="nav-text">常见问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#用注解还是用-xml-配置？"><span class="nav-number">1.3.1.</span> <span class="nav-text">用注解还是用 xml 配置？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mapper-接口无法注入或-Invalid-bound-statement-not-found"><span class="nav-number">1.3.2.</span> <span class="nav-text">Mapper 接口无法注入或 Invalid bound statement (not found)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么获取插入的最新自动生成的-ID"><span class="nav-number">1.3.3.</span> <span class="nav-text">怎么获取插入的最新自动生成的 ID</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何实现模糊查询-LIKE"><span class="nav-number">1.3.4.</span> <span class="nav-text">如何实现模糊查询 LIKE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么时候用-，什么时候用-？"><span class="nav-number">1.3.5.</span> <span class="nav-text">什么时候用#{}，什么时候用${}？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对象属性是基本类型-int-double，数据库返回-null-是报错"><span class="nav-number">1.3.6.</span> <span class="nav-text">对象属性是基本类型 int double，数据库返回 null 是报错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#If-test-null-失效了？"><span class="nav-number">1.3.7.</span> <span class="nav-text">If test !&#x3D;null 失效了？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML-中怎么使用特殊符号，比如小于-amp"><span class="nav-number">1.3.8.</span> <span class="nav-text">XML 中怎么使用特殊符号，比如小于 &amp;</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">shoufeng</p>
  <div class="site-description" itemprop="description">工作学习笔记</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">32</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shoufeng</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
